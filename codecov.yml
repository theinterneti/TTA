# Codecov Configuration for TTA
# See: https://docs.codecov.com/docs/codecov-yaml

codecov:
  require_ci_to_pass: yes
  notify:
    wait_for_ci: yes

coverage:
  precision: 2
  round: down
  range: "60...100"

  status:
    project:
      default:
        target: 70%
        threshold: 2%
        base: auto
        if_ci_failed: error

    patch:
      default:
        target: 60%
        threshold: 5%
        base: auto

    changes:
      default:
        branches:
          - main
          - staging

# Component-specific coverage targets aligned with TTA maturity workflow
component_management:
  individual_components:
    - component_id: "agent_orchestration"
      name: "Agent Orchestration"
      paths:
        - "src/agent_orchestration/**"
      coverage:
        target: 70%
        threshold: 2%

    - component_id: "player_experience"
      name: "Player Experience"
      paths:
        - "src/player_experience/**"
      coverage:
        target: 70%
        threshold: 2%

    - component_id: "components"
      name: "Core TTA Components"
      paths:
        - "src/components/**"
      coverage:
        target: 70%
        threshold: 2%

    - component_id: "observability"
      name: "Observability & Integration"
      paths:
        - "src/observability_integration/**"
      coverage:
        target: 85%
        threshold: 2%

    - component_id: "orchestration"
      name: "Orchestration Layer"
      paths:
        - "src/orchestration/**"
      coverage:
        target: 70%
        threshold: 2%

comment:
  layout: "reach,diff,flags,files,footer"
  behavior: default
  require_changes: no
  require_base: no
  require_head: yes
  show_carryforward_flags: yes

ignore:
  - "tests/**"
  - "scripts/**"
  - "docs/**"
  - "**/__pycache__/**"
  - "**/conftest.py"
  - "**/.venv/**"
  - "**/node_modules/**"
  - "htmlcov/**"
  - ".augment/**"
  - "packages/**" # Dev toolkit packages tested separately

flags:
  unit:
    paths:
      - src/
    carryforward: true

  integration:
    paths:
      - src/
    carryforward: true

  e2e:
    paths:
      - src/
    carryforward: false

github_checks:
  annotations: true
