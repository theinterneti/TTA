# Neo4j Configuration for TTA Staging Environment
# Optimized for homelab staging deployment

#*****************************************************************
# Network connector configuration
#*****************************************************************

# Bolt connector
server.bolt.enabled=true
server.bolt.listen_address=0.0.0.0:7687
server.bolt.advertised_address=:7687

# HTTP Connector
server.http.enabled=true
server.http.listen_address=0.0.0.0:7474
server.http.advertised_address=:7474

# HTTPS Connector (disabled for staging)
server.https.enabled=false

#*****************************************************************
# Memory settings - Staging optimized
#*****************************************************************

# Initial heap size
server.memory.heap.initial_size=1G

# Maximum heap size
server.memory.heap.max_size=4G

# Page cache size
server.memory.pagecache.size=2G

#*****************************************************************
# Database configuration
#*****************************************************************

# Default database
server.default_database=tta_staging

# Transaction timeout (30 minutes for staging)
db.transaction.timeout=30m

# Query timeout (10 minutes for staging)
db.transaction.concurrent.maximum=1000

#*****************************************************************
# Logging configuration
#*****************************************************************

# Log level
server.logs.debug.level=INFO

# Query logging (enabled for staging debugging)
server.logs.query.enabled=true
server.logs.query.threshold=1s
server.logs.query.parameter_logging_enabled=true

# Security event logging
server.logs.security.level=INFO

#*****************************************************************
# Security configuration
#*****************************************************************

# Authentication and authorization
server.security.auth_enabled=true

# Procedures configuration
server.security.procedures.unrestricted=apoc.*,gds.*

# Allow file URLs (restricted for staging)
server.security.allow_csv_import_from_file_urls=false

#*****************************************************************
# Performance tuning for staging
#*****************************************************************

# Cypher runtime
server.cypher.default_language_version=5

# Parallel runtime
server.cypher.parallel_runtime_support=all

# Query cache
server.cypher.query_cache_size=1000

# Planner
server.cypher.planner=cost

#*****************************************************************
# Backup configuration
#*****************************************************************

# Enable online backup
server.backup.enabled=true
server.backup.listen_address=0.0.0.0:6362

#*****************************************************************
# Metrics and monitoring
#*****************************************************************

# Enable metrics
server.metrics.enabled=true
server.metrics.jmx.enabled=true
server.metrics.prometheus.enabled=true
server.metrics.prometheus.endpoint=0.0.0.0:2004

# CSV metrics
server.metrics.csv.enabled=true
server.metrics.csv.interval=30s

#*****************************************************************
# Network and clustering (single instance for staging)
#*****************************************************************

# Server ID
server.cluster.server_id=1

# Advertised addresses
server.cluster.advertised_address=neo4j-staging:7687
server.cluster.raft.advertised_address=neo4j-staging:7000

#*****************************************************************
# Storage configuration
#*****************************************************************

# Store files location
server.directories.data=/data
server.directories.logs=/logs
server.directories.lib=/var/lib/neo4j/lib
server.directories.plugins=/plugins

# Transaction log configuration
server.tx_log.rotation.retention_policy=7 days
server.tx_log.rotation.size=250M

#*****************************************************************
# JVM configuration for staging
#*****************************************************************

# GC settings optimized for staging workload
server.jvm.additional=-XX:+UseG1GC
server.jvm.additional=-XX:+UnlockExperimentalVMOptions
server.jvm.additional=-XX:+TrustFinalNonStaticFields
server.jvm.additional=-XX:+DisableExplicitGC
server.jvm.additional=-XX:MaxGCPauseMillis=300
server.jvm.additional=-XX:G1HeapRegionSize=16m

# Memory mapping
server.jvm.additional=-Djdk.nio.maxCachedBufferSize=262144

#*****************************************************************
# Staging-specific settings
#*****************************************************************

# Enable experimental features for testing
server.cypher.forbid_exhaustive_shortestpath=false
server.cypher.forbid_shortestpath_common_nodes=false

# Relaxed constraints for staging data
server.cypher.lenient_create_relationship=true

# Enhanced debugging
server.logs.gc.enabled=true
server.logs.gc.options=all
server.logs.gc.rotation.keep_number=10

# Development helpers
server.unmanaged_extension_classes=n10s.endpoint=/rdf

#*****************************************************************
# Plugin configuration
#*****************************************************************

# APOC configuration
apoc.export.file.enabled=true
apoc.import.file.enabled=true
apoc.import.file.use_neo4j_config=true

# Graph Data Science configuration
gds.enterprise.license_file=

#*****************************************************************
# Staging environment markers
#*****************************************************************

# Custom properties for staging identification
server.config.strict_validation.enabled=false
server.default_advertised_address=neo4j-staging
