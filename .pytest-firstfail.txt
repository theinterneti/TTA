.........................................................F
=================================== FAILURES ===================================
___________ TestEndToEndUserWorkflows.test_complete_new_user_journey ___________

self = <tests.test_end_to_end_workflows.TestEndToEndUserWorkflows object at 0x7f1b9c637710>
client = <starlette.testclient.TestClient object at 0x7f1b9a8ba7d0>

    def test_complete_new_user_journey(self, client):
        """Test complete journey for a new user from registration to therapeutic interaction."""
        player_id = "new-user-123"
        token = create_auth_token(player_id, "newuser", "newuser@example.com")
        headers = {"Authorization": f"Bearer {token}"}

        # Step 1: Create player profile
        profile_data = {
            "username": "newuser",
            "email": "newuser@example.com",
            "therapeutic_preferences": {
                "intensity_level": "medium",
                "preferred_approaches": ["cbt", "mindfulness"],
                "trigger_warnings": ["violence"],
                "comfort_topics": ["relationships"],
                "avoid_topics": ["trauma"]
            },
            "privacy_settings": {
                "data_sharing_consent": True,
                "research_participation": False,
                "contact_preferences": ["email"]
            }
        }

        response = client.post("/api/v1/players/", json=profile_data, headers=headers)
>       assert response.status_code == 201
E       assert 422 == 201
E        +  where 422 = <Response [422 Unprocessable Entity]>.status_code

tests/test_end_to_end_workflows.py:113: AssertionError
------------------------------ Captured log call -------------------------------
INFO     src.player_experience.api.middleware::0 Request started: POST /api/v1/players/
INFO     src.player_experience.api.middleware::0 Request completed: 422
DEBUG    src.player_experience.monitoring.performance_monitor::0 Request 57fd0acb-6aea-4f5e-91b0-4fff36b3cd4d completed in 0.004s
=============================== warnings summary ===============================
.venv/lib/python3.11/site-packages/passlib/utils/__init__.py:854
  /home/thein/projects/projects/TTA/.venv/lib/python3.11/site-packages/passlib/utils/__init__.py:854: DeprecationWarning: 'crypt' is deprecated and slated for removal in Python 3.13
    from crypt import crypt as _crypt

.venv/lib/python3.11/site-packages/pythonjsonlogger/jsonlogger.py:11
  /home/thein/projects/projects/TTA/.venv/lib/python3.11/site-packages/pythonjsonlogger/jsonlogger.py:11: DeprecationWarning: pythonjsonlogger.jsonlogger has been moved to pythonjsonlogger.json
    warnings.warn(

src/player_experience/api/config.py:124
  /home/thein/projects/projects/TTA/src/player_experience/api/config.py:124: PytestCollectionWarning: cannot collect test class 'TestingSettings' because it has a __init__ constructor (from: tests/test_api_integration.py)
    class TestingSettings(APISettings):

src/player_experience/api/config.py:124
  /home/thein/projects/projects/TTA/src/player_experience/api/config.py:124: PytestCollectionWarning: cannot collect test class 'TestingSettings' because it has a __init__ constructor (from: tests/test_api_structure.py)
    class TestingSettings(APISettings):

src/player_experience/api/config.py:124
  /home/thein/projects/projects/TTA/src/player_experience/api/config.py:124: PytestCollectionWarning: cannot collect test class 'TestingSettings' because it has a __init__ constructor (from: tests/test_character_management_api.py)
    class TestingSettings(APISettings):

src/player_experience/api/config.py:124
  /home/thein/projects/projects/TTA/src/player_experience/api/config.py:124: PytestCollectionWarning: cannot collect test class 'TestingSettings' because it has a __init__ constructor (from: tests/test_end_to_end_workflows.py)
    class TestingSettings(APISettings):

tests/test_player_experience_orchestration_integration.py:359
  /home/thein/projects/projects/TTA/tests/test_player_experience_orchestration_integration.py:359: PytestUnknownMarkWarning: Unknown pytest.mark.integration - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.integration

src/player_experience/api/config.py:124
  /home/thein/projects/projects/TTA/src/player_experience/api/config.py:124: PytestCollectionWarning: cannot collect test class 'TestingSettings' because it has a __init__ constructor (from: tests/test_websocket_chat_backend.py)
    class TestingSettings(APISettings):

src/player_experience/api/config.py:124
  /home/thein/projects/projects/TTA/src/player_experience/api/config.py:124: PytestCollectionWarning: cannot collect test class 'TestingSettings' because it has a __init__ constructor (from: tests/test_websocket_chat_backend_task8_2.py)
    class TestingSettings(APISettings):

src/player_experience/api/config.py:124
  /home/thein/projects/projects/TTA/src/player_experience/api/config.py:124: PytestCollectionWarning: cannot collect test class 'TestingSettings' because it has a __init__ constructor (from: tests/test_websocket_chat_interactive.py)
    class TestingSettings(APISettings):

src/player_experience/api/config.py:124
  /home/thein/projects/projects/TTA/src/player_experience/api/config.py:124: PytestCollectionWarning: cannot collect test class 'TestingSettings' because it has a __init__ constructor (from: tests/test_websocket_chat_typing_and_metrics.py)
    class TestingSettings(APISettings):

src/player_experience/api/config.py:124
  /home/thein/projects/projects/TTA/src/player_experience/api/config.py:124: PytestCollectionWarning: cannot collect test class 'TestingSettings' because it has a __init__ constructor (from: tests/test_world_management_api.py)
    class TestingSettings(APISettings):

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ============================
FAILED tests/test_end_to_end_workflows.py::TestEndToEndUserWorkflows::test_complete_new_user_journey
!!!!!!!!!!!!!!!!!!!!!!!!!! stopping after 1 failures !!!!!!!!!!!!!!!!!!!!!!!!!!!
