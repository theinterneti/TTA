# Component Documentation Sync Guide

**Purpose**: Prevent documentation drift and ensure consistency between automated reporting and manual documentation

**Created**: 2025-10-13
**Last Updated**: 2025-10-13

---

## Quick Start

### Validate Documentation Before Committing

```bash
# Run validation script
./scripts/validate-component-metrics.sh

# If validation passes, commit as normal
git add docs/component-promotion/*.md
git commit -m "docs: update component promotion status"

# If validation fails, fix inconsistencies first
```

---

## Single Source of Truth

### Primary Sources (Automated, Always Current)

1. **GitHub Issue #42** - Component Status Report
   - Updated daily by GitHub Actions
   - Contains current coverage, blockers, status for all components
   - **This is the authoritative source**

2. **component-maturity-analysis.json**
   - Generated by `scripts/analyze-component-maturity.py`
   - Contains detailed metrics for all components
   - Used by GitHub Actions to generate Issue #42

### Secondary Sources (Manual, Must Be Synced)

1. **docs/component-promotion/COMPONENT_MATURITY_STATUS.md**
   - Overall component status and promotion pipeline
   - Must match GitHub Issue #42

2. **docs/component-promotion/TOP_3_PRIORITIES.md**
   - Top 3 priority components for promotion
   - Must match GitHub Issue #42

3. **Other promotion planning documents**
   - Component-specific promotion plans
   - Must reference GitHub Issue #42 for current metrics

---

## Validation Workflow

### Step 1: Check Current Metrics

```bash
# View current component metrics
python3 scripts/sync-component-docs.py --report
```

**Output Example**:
```
## AI/Agent Systems
--------------------------------------------------------------------------------
üî¥ Narrative Arc Orchestrator      | Coverage:  42.9% | Stage: Development  | Blockers: 1
üü¢ Model Management                | Coverage: 100.0% | Stage: Development  | Blockers: 2
```

### Step 2: Validate Documentation

```bash
# Check for inconsistencies
python3 scripts/sync-component-docs.py --dry-run
```

**If Consistent**:
```
‚úÖ All documentation is consistent with component metrics!
```

**If Inconsistent**:
```
‚ùå INCONSISTENCY: Narrative Arc Orchestrator
   Document states: 70.3%
   Actual coverage: 42.9%
   Line: Narrative Arc Orchestrator | 70.3% | Ready for Staging
```

### Step 3: Fix Inconsistencies

1. **Identify the discrepancy** from validation output
2. **Check GitHub Issue #42** for current, accurate data
3. **Update documentation** to match GitHub Issue #42
4. **Re-run validation** to confirm fix

```bash
# After fixing, validate again
python3 scripts/sync-component-docs.py --dry-run
```

### Step 4: Commit Changes

```bash
# Only commit after validation passes
git add docs/component-promotion/*.md
git commit -m "docs: sync component metrics with GitHub Issue #42"
```

---

## Common Scenarios

### Scenario 1: Updating Component Status

**Situation**: A component's coverage has changed

**Steps**:
1. Wait for GitHub Actions to update Issue #42 (runs daily)
2. Check new coverage in Issue #42
3. Update documentation to match
4. Run validation
5. Commit

**Example**:
```bash
# 1. Check GitHub Issue #42 for latest coverage
# 2. Update COMPONENT_MATURITY_STATUS.md
# 3. Validate
python3 scripts/sync-component-docs.py --dry-run
# 4. Commit
git commit -m "docs: update Narrative Arc Orchestrator coverage to 42.9%"
```

### Scenario 2: Creating New Promotion Plan

**Situation**: Creating a promotion plan for a component

**Steps**:
1. Check GitHub Issue #42 for current metrics
2. Create promotion plan document
3. Reference GitHub Issue #42 in the document
4. Include current metrics from Issue #42
5. Run validation
6. Commit

**Example**:
```markdown
# Component Promotion Plan

**Coverage**: 70.6% (per GitHub Issue #42, 2025-10-13)
**Source**: GitHub Issue #42 - Component Status Report

<!-- Always reference the source of truth -->
```

### Scenario 3: Validation Fails

**Situation**: Validation script reports inconsistencies

**Steps**:
1. Review validation output carefully
2. Identify which document has incorrect data
3. Check GitHub Issue #42 for correct data
4. Update document to match Issue #42
5. Re-run validation
6. Commit only after validation passes

**Example**:
```bash
# Validation fails
./scripts/validate-component-metrics.sh
# Output shows: "Document states: 70.3%, Actual: 42.9%"

# Fix the document
vim docs/component-promotion/COMPONENT_MATURITY_STATUS.md
# Change 70.3% to 42.9%

# Validate again
./scripts/validate-component-metrics.sh
# Output: "‚úÖ VALIDATION PASSED"

# Commit
git commit -m "docs: correct Narrative Arc Orchestrator coverage to 42.9%"
```

---

## Best Practices

### DO ‚úÖ

1. **Always check GitHub Issue #42** before updating documentation
2. **Run validation** before committing documentation changes
3. **Reference the source** when stating metrics (e.g., "per GitHub Issue #42")
4. **Add correction notices** to outdated documents rather than deleting them
5. **Use automated reporting** as the source of truth

### DON'T ‚ùå

1. **Don't copy metrics** from old documents without verification
2. **Don't commit** documentation changes without running validation
3. **Don't trust** manual documentation over automated reporting
4. **Don't delete** outdated documents - mark them as archived instead
5. **Don't bypass validation** unless absolutely necessary

---

## Troubleshooting

### Validation Script Not Found

**Error**: `python3: can't open file 'scripts/sync-component-docs.py'`

**Solution**:
```bash
# Ensure you're in the repository root
cd /path/to/recovered-tta-storytelling

# Verify script exists
ls -la scripts/sync-component-docs.py

# Make script executable
chmod +x scripts/sync-component-docs.py
```

### Metrics File Not Found

**Error**: `component-maturity-analysis.json not found`

**Solution**:
```bash
# Generate metrics file
uv run python scripts/analyze-component-maturity.py

# Verify file was created
ls -la component-maturity-analysis.json

# Run validation again
python3 scripts/sync-component-docs.py --dry-run
```

### Validation Fails But Data Looks Correct

**Possible Causes**:
1. Rounding differences (e.g., 70.6% vs 70.56%)
2. Stale metrics file
3. Recent code changes not yet reflected in metrics

**Solution**:
```bash
# Regenerate metrics file
uv run python scripts/analyze-component-maturity.py

# Run validation again
python3 scripts/sync-component-docs.py --dry-run

# If still failing, check GitHub Issue #42 directly
# The issue is updated daily and is the ultimate source of truth
```

---

## Automation Setup (Future Enhancement)

### Pre-commit Hook Integration

Add to `.pre-commit-config.yaml`:

```yaml
repos:
  - repo: local
    hooks:
      - id: validate-component-metrics
        name: Validate component metrics consistency
        entry: scripts/validate-component-metrics.sh
        language: script
        pass_filenames: false
        files: ^(docs/component-promotion/.*\.md|component-maturity-analysis\.json)$
```

**Install pre-commit hooks**:
```bash
# Install pre-commit
pip install pre-commit

# Install hooks
pre-commit install

# Test hooks
pre-commit run --all-files
```

### GitHub Actions Integration

Add to `.github/workflows/component-status-report.yml`:

```yaml
- name: Validate documentation consistency
  run: |
    python3 scripts/sync-component-docs.py --dry-run
    if [ $? -ne 0 ]; then
      echo "‚ùå Documentation inconsistencies detected!"
      echo "Please update documentation to match component-maturity-analysis.json"
      exit 1
    fi
```

---

## Related Documentation

- **Component Status Report**: GitHub Issue #42 (single source of truth)
- **Component Maturity Status**: `docs/component-promotion/COMPONENT_MATURITY_STATUS.md`
- **Validation Script**: `scripts/sync-component-docs.py`
- **Validation Shell Script**: `scripts/validate-component-metrics.sh`
- **Correction Summary**: `COMPONENT_PROMOTION_CORRECTION_SUMMARY.md`

---

## Support

**Questions or Issues?**

1. Check GitHub Issue #42 for current component status
2. Run `python3 scripts/sync-component-docs.py --report` for metrics summary
3. Review this guide for common scenarios
4. Check `COMPONENT_PROMOTION_CORRECTION_SUMMARY.md` for context on recent changes

---

**Created**: 2025-10-13
**Maintained By**: @theinterneti
**Last Validated**: 2025-10-13
